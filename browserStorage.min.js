function BrowserStorage(f,v){function w(a){for(var b in a)if(a.hasOwnProperty(b))return q=0,!1;return!0}function h(a){if(""===a)return{};a=a.split("%a");q=a.length;for(var b={},d,c=0;c<a.length;c++)d=a[c].split("%b"),b[d[0].replace(x,"%")]=(d[1]||"").replace(x,"%");return b}function t(a){var b=[],d=0,c;for(c in a)a.hasOwnProperty(c)&&(d++,b.push(c.replace(y,"%p")+"%b"+a[c].replace(y,"%p")));q=d;return b.join("%a")}function l(a,b,d,c){if("function"!==typeof a||"function"!==typeof b||"function"!==typeof d)throw Error("TypeError: expected type function, found "+
("function"!==typeof a?typeof a:"function"!==typeof b?typeof b:typeof d));c=null==c?String.fromCharCode(++z):c;m[c]=[b,d];n[a.name]=c;r.push(a)}function A(a,b,d){var c=String.fromCharCode(++z);m[c]=[b,d];n[""+a]=c;r.push(""+a)}function u(a){if(a[0]){var b=a[0],d=a.substring(1);if(m[b])return m[b][1](d);throw Error('Missing deserializer for string "'+a+'"');}return""}function B(a,b,d){if(a.addEventListener)return a.addEventListener(b,d,!1),!0;if(a.attachEvent)return a.attachEvent("on"+b,d);b="on"+
b;"function"===typeof a[b]&&(d=function(a,b){return function(){a.apply(this,arguments);b.apply(this,arguments)}}(a[b],d));a[b]=d;return!0}var m={},n={},r=[],z=32,c={},e="",q=0,y=/%/g,x=/%p/g;A("undefined",function(){return"undefined"},function(){});A("null",function(){return"null"},function(){return null});l(String,function(a){return a},function(a){return a});l(Number,function(a){return""+a},function(a){return+a});l(Boolean,function(a){return""+a},function(a){return"true"===a});l(Object,function(a){return JSON.stringify(a)},
function(a){return JSON.parse(a)});l(Date,function(a){return+a},function(a){return new Date(+a)});var k=[];if(window.localStorage&&!v){var g=window.localStorage;B(window,"storage",function(a){if(a.key===f){e=g.getItem(f)||"";c=h(e);for(var b=0;b<k.length;b++)k[b](a)}})}else if(window.sessionStorage&&v)g=window.sessionStorage,B(window,"storage",function(a){if(a.key===f){e=g.getItem(f)||"";c=h(e);for(var b=0;b<k.length;b++)k[b](a)}});else{var D=v?"":";expires="+new Date(+new Date+307584E5);g={getItem:function(a){if(0<
document.cookie.length){var b=document.cookie.indexOf(a+"=");if(-1!==b)return b=b+a.length+1,a=document.cookie.indexOf(";",b),-1===a&&(a=document.cookie.length),decodeURIComponent(document.cookie.substring(b,a))}return""},setItem:function(a,b){document.cookie=a+"="+encodeURIComponent(b)+D+"; path=/"},removeItem:function(a){document.cookie=a+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/"},clear:function(){for(var a=document.cookie.split(";"),b=0;b<a.length;b++){var d=a[b],c=d.indexOf("=");d=-1<
c?d.substr(0,c):d;document.cookie=d+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/"}}};setInterval(function(){var a=g.getItem(f)||"";if(a!==e)for(e=a,c=h(e),a=0;a<k.length;a++)k[a]()},500)}var C=g.getItem(f);null!==C&&(e=C,c=h(e));var p={get:function(a,b){b&&(e=g.getItem(f)||"",c=h(e));return a in c?u(c[a]):null},getOrDefault:function(a,b,d){d&&(e=g.getItem(f)||"",c=h(e));return a in c?u(c[a]):b},getOrElse:function(a,b,d){d&&(e=g.getItem(f)||"",c=h(e));return a in c?u(c[a]):b(a)},forEach:function(a,
b){b&&(e=g.getItem(f)||"",c=h(e));for(var d in c)c.hasOwnProperty(d)&&a(d,u(c[d]));return p},contains:function(a,b){b&&(e=g.getItem(f)||"",c=h(e));return a in c},set:function(a,b){e=g.getItem(f)||"";c=h(e);a:if(n[b]){var d=n[""+b];d+=m[d][0](b)}else if(b.constructor&&b.constructor.name&&n[b.constructor.name])d=n[b.constructor.name],d+=m[d][0](b);else{for(d=0;d<r.length;d++)if("function"===typeof r[d]&&b instanceof r[d]){d=n[r[d].name];d+=m[d][0](b);break a}throw Error("Missing serializer for object "+
b+" (type "+typeof b+")");}if(a in c)c[a]=d,e=t(c);else if(""===e)c={},c[a]=d,e=t(c);else{var k={};k[a]=d;var l=q;e+="%a"+t(k);q=l+1;c[a]=d}g.setItem(f,e);return p},remove:function(a){e=g.getItem(f)||"";c=h(e);a in c&&(delete c[a],e=t(c),w(c)?g.removeItem(f):g.setItem(f,e));return p},clear:function(){g.removeItem(f);c={};e="";return p},isEmpty:function(a){a&&(e=g.getItem(f)||"",c=h(e));return w(c)},length:function(a){a&&(e=g.getItem(f)||"",c=h(e));return q},addListener:function(a){k.push(a);return p},
removeListener:function(a){for(var b=0;b<k.length;b++)k[b]===a&&k.splice(b,1);return p},addType:function(a,b,c,e){if(isNaN(a)||50>a)throw Error("Identifier must be a number >= 50");if(m[a])throw Error("This ID is already in use");l(b,c,e,String.fromCharCode(a))}};return p};